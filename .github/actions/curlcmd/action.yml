name: github-release-create
description: 'Upload release asset file (day and month release)'
inputs:
  owdebug:
    description: 'verbosed/debug output for GH Actions scripts development'
    required: false
    default: ''
    type: string
outputs:
  cov:
    description: 'curl command for Coverity site'
    value: ${{ steps.curlcmd.outputs.cov }}
  gh:
    description: 'curl command for GitHub REST API'
    value: ${{ steps.curlcmd.outputs.gh }}
runs:
  using: composite
  steps:
  - name: Setup curl options
    id: curlcmd
    run: |
      if( "${{ inputs.owdebug }}" -eq '1' ) {
        $curl_cov = "curl -sv"
      } else {
        $curl_cov = "curl -s"
      }
      $curl_gh = $curl_cov + " -L -H `"Accept: application/vnd.github+json`" -H `"Authorization: Bearer ${{ github.token }}`" -H `"X-GitHub-Api-Version: 2022-11-28`""
      "cov=$curl_cov" | Out-File -FilePath ${{ github.output }} -Encoding utf8 -Append
      "gh=$curl_gh" | Out-File -FilePath ${{ github.output }} -Encoding utf8 -Append
      if( "${{ inputs.owdebug }}" -eq '1' ) {
        echo "cov=$curl_cov"
        echo "gh=$curl_gh"
      }
    shell: pwsh
